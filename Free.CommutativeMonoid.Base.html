<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Free.CommutativeMonoid.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Algebra.Structure.OICM.html" class="Module">Algebra.Structure.OICM</a>

<a id="73" class="Keyword">module</a> <a id="80" href="Free.CommutativeMonoid.Base.html" class="Module">Free.CommutativeMonoid.Base</a>
  <a id="110" class="Symbol">{</a><a id="111" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a> <a id="113" class="Symbol">:</a> <a id="115" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="118" class="Symbol">}</a> <a id="120" class="Symbol">{</a><a id="121" href="Free.CommutativeMonoid.Base.html#121" class="Bound Operator">_≈_</a> <a id="125" class="Symbol">:</a> <a id="127" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a> <a id="129" class="Symbol">→</a> <a id="131" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a> <a id="133" class="Symbol">→</a> <a id="135" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="138" class="Symbol">}</a> <a id="140" class="Symbol">{</a><a id="141" href="Free.CommutativeMonoid.Base.html#141" class="Bound Operator">_≤_</a> <a id="145" class="Symbol">:</a> <a id="147" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a> <a id="149" class="Symbol">→</a> <a id="151" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a> <a id="153" class="Symbol">→</a> <a id="155" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="158" class="Symbol">}</a>
  <a id="162" class="Symbol">(</a><a id="163" href="Free.CommutativeMonoid.Base.html#163" class="Bound">≤-PDTO</a> <a id="170" class="Symbol">:</a> <a id="172" href="Algebra.Structure.OICM.html#652" class="Record">IsPropDecTotalOrder</a> <a id="192" href="Free.CommutativeMonoid.Base.html#121" class="Bound Operator">_≈_</a> <a id="196" href="Free.CommutativeMonoid.Base.html#141" class="Bound Operator">_≤_</a><a id="199" class="Symbol">)</a>
  <a id="203" class="Keyword">where</a>

<a id="210" class="Keyword">open</a> <a id="215" class="Keyword">import</a> <a id="222" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="231" class="Keyword">open</a> <a id="236" class="Keyword">import</a> <a id="243" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="252" class="Keyword">using</a> <a id="258" class="Symbol">(</a><a id="259" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="260" class="Symbol">;</a> <a id="262" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="266" class="Symbol">;</a> <a id="268" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a><a id="271" class="Symbol">;</a> <a id="273" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+_</a><a id="276" class="Symbol">;</a> <a id="278" href="Data.Nat.Base.html#1496" class="InductiveConstructor">z≤n</a><a id="281" class="Symbol">;</a> <a id="283" href="Data.Nat.Base.html#1538" class="InductiveConstructor">s≤s</a><a id="286" class="Symbol">)</a>
                     <a id="309" class="Keyword">renaming</a> <a id="318" class="Symbol">(</a><a id="319" href="Data.Nat.Base.html#1473" class="Datatype Operator">_≤_</a> <a id="323" class="Symbol">to</a> <a id="326" class="Datatype Operator">_≤ℕ_</a><a id="330" class="Symbol">;</a> <a id="332" href="Data.Nat.Base.html#1583" class="Function Operator">_&lt;_</a> <a id="336" class="Symbol">to</a> <a id="339" class="Function Operator">_&lt;ℕ_</a><a id="343" class="Symbol">)</a>
<a id="345" class="Keyword">open</a> <a id="350" class="Keyword">import</a> <a id="357" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
  <a id="379" class="Keyword">using</a> <a id="385" class="Symbol">(</a><a id="386" href="Data.Nat.Properties.html#3547" class="Function">1+n≢n</a><a id="391" class="Symbol">;</a> <a id="393" href="Data.Nat.Properties.html#3511" class="Function">1+n≢0</a><a id="398" class="Symbol">;</a> <a id="400" href="Data.Nat.Properties.html#14579" class="Function">+-identityʳ</a><a id="411" class="Symbol">;</a> <a id="413" href="Data.Nat.Properties.html#18564" class="Function">m≤m+n</a><a id="418" class="Symbol">;</a> <a id="420" href="Data.Nat.Properties.html#14215" class="Function">+-suc</a><a id="425" class="Symbol">;</a> <a id="427" href="Data.Nat.Properties.html#2327" class="Function">suc-injective</a><a id="440" class="Symbol">;</a> <a id="442" href="Data.Nat.Properties.html#14423" class="Function">+-assoc</a><a id="449" class="Symbol">;</a> <a id="451" href="Data.Nat.Properties.html#14756" class="Function">+-comm</a><a id="457" class="Symbol">)</a>
  <a id="461" class="Keyword">renaming</a> <a id="470" class="Symbol">(</a><a id="471" href="Data.Nat.Properties.html#7610" class="Function">≤-step</a> <a id="478" class="Symbol">to</a> <a id="481" class="Function">≤ℕ-step</a><a id="488" class="Symbol">;</a> <a id="490" href="Data.Nat.Properties.html#4928" class="Function">≤-refl</a> <a id="497" class="Symbol">to</a> <a id="500" class="Function">≤ℕ-refl</a><a id="507" class="Symbol">;</a> <a id="509" href="Data.Nat.Properties.html#5111" class="Function">≤-trans</a> <a id="517" class="Symbol">to</a> <a id="520" class="Function">≤ℕ-trans</a><a id="528" class="Symbol">;</a> <a id="530" href="Data.Nat.Properties.html#4822" class="Function">≤-reflexive</a> <a id="542" class="Symbol">to</a> <a id="545" class="Function">≤ℕ-reflexive</a><a id="557" class="Symbol">)</a>
<a id="559" class="Keyword">open</a> <a id="564" class="Keyword">import</a> <a id="571" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>
<a id="590" class="Keyword">open</a> <a id="595" class="Keyword">import</a> <a id="602" href="Induction.WellFounded.html" class="Module">Induction.WellFounded</a>




<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">import</a> <a id="640" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="679" class="Keyword">open</a> <a id="684" class="Keyword">import</a> <a id="691" href="Data.FreshList.InductiveInductive.html" class="Module">Data.FreshList.InductiveInductive</a>

<a id="726" class="Keyword">private</a>
  <a id="total"></a><a id="736" href="Free.CommutativeMonoid.Base.html#736" class="Function">total</a>   <a id="744" class="Symbol">=</a> <a id="746" href="Relation.Binary.Structures.html#5276" class="Function">IsPropDecTotalOrder.total</a> <a id="772" href="Free.CommutativeMonoid.Base.html#163" class="Bound">≤-PDTO</a>
  <a id="≤-refl"></a><a id="781" href="Free.CommutativeMonoid.Base.html#781" class="Function">≤-refl</a>  <a id="789" class="Symbol">=</a> <a id="791" href="Relation.Binary.Structures.html#2447" class="Function">IsPropDecTotalOrder.refl</a> <a id="816" href="Free.CommutativeMonoid.Base.html#163" class="Bound">≤-PDTO</a>
  <a id="≤-trans"></a><a id="825" href="Free.CommutativeMonoid.Base.html#825" class="Function">≤-trans</a> <a id="833" class="Symbol">=</a> <a id="835" href="Relation.Binary.Structures.html#2370" class="Function">IsPropDecTotalOrder.trans</a> <a id="861" href="Free.CommutativeMonoid.Base.html#163" class="Bound">≤-PDTO</a>

<a id="SortedList"></a><a id="869" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a> <a id="880" class="Symbol">:</a> <a id="882" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="886" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a> <a id="897" class="Symbol">=</a> <a id="899" href="Data.FreshList.InductiveInductive.html#446" class="Datatype">List#</a> <a id="905" href="Free.CommutativeMonoid.Base.html#141" class="Bound Operator">_≤_</a>

<a id="910" class="Comment">----------------</a>
<a id="927" class="Comment">-- Merge Sort --</a>
<a id="944" class="Comment">----------------</a>

<a id="union"></a><a id="962" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="968" class="Symbol">:</a> <a id="970" class="Symbol">(</a><a id="971" href="Free.CommutativeMonoid.Base.html#971" class="Bound">xs</a> <a id="974" href="Free.CommutativeMonoid.Base.html#974" class="Bound">ys</a> <a id="977" class="Symbol">:</a> <a id="979" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a><a id="989" class="Symbol">)</a> <a id="991" class="Symbol">→</a> <a id="993" href="Induction.WellFounded.html#1009" class="Datatype">Acc</a> <a id="997" href="Free.CommutativeMonoid.Base.html#339" class="Function Operator">_&lt;ℕ_</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Data.FreshList.InductiveInductive.html#4825" class="Function">length</a> <a id="1010" href="Free.CommutativeMonoid.Base.html#971" class="Bound">xs</a> <a id="1013" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1015" href="Data.FreshList.InductiveInductive.html#4825" class="Function">length</a> <a id="1022" href="Free.CommutativeMonoid.Base.html#974" class="Bound">ys</a><a id="1024" class="Symbol">)</a> <a id="1026" class="Symbol">→</a> <a id="1028" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a>
<a id="union-fresh"></a><a id="1039" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1051" class="Symbol">:</a> <a id="1053" class="Symbol">{</a><a id="1054" href="Free.CommutativeMonoid.Base.html#1054" class="Bound">a</a> <a id="1056" class="Symbol">:</a> <a id="1058" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a><a id="1059" class="Symbol">}</a> <a id="1061" class="Symbol">{</a><a id="1062" href="Free.CommutativeMonoid.Base.html#1062" class="Bound">xs</a> <a id="1065" href="Free.CommutativeMonoid.Base.html#1065" class="Bound">ys</a> <a id="1068" class="Symbol">:</a> <a id="1070" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a><a id="1080" class="Symbol">}</a> <a id="1082" class="Symbol">{</a><a id="1083" href="Free.CommutativeMonoid.Base.html#1083" class="Bound">p</a> <a id="1085" class="Symbol">:</a> <a id="1087" href="Induction.WellFounded.html#1009" class="Datatype">Acc</a> <a id="1091" href="Free.CommutativeMonoid.Base.html#339" class="Function Operator">_&lt;ℕ_</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Data.FreshList.InductiveInductive.html#4825" class="Function">length</a> <a id="1104" href="Free.CommutativeMonoid.Base.html#1062" class="Bound">xs</a> <a id="1107" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="1109" href="Data.FreshList.InductiveInductive.html#4825" class="Function">length</a> <a id="1116" href="Free.CommutativeMonoid.Base.html#1065" class="Bound">ys</a><a id="1118" class="Symbol">)}</a> <a id="1121" class="Symbol">→</a> <a id="1123" href="Free.CommutativeMonoid.Base.html#1054" class="Bound">a</a> <a id="1125" href="Data.FreshList.InductiveInductive.html#509" class="Datatype Operator">#</a> <a id="1127" href="Free.CommutativeMonoid.Base.html#1062" class="Bound">xs</a> <a id="1130" class="Symbol">→</a> <a id="1132" href="Free.CommutativeMonoid.Base.html#1054" class="Bound">a</a> <a id="1134" href="Data.FreshList.InductiveInductive.html#509" class="Datatype Operator">#</a> <a id="1136" href="Free.CommutativeMonoid.Base.html#1065" class="Bound">ys</a> <a id="1139" class="Symbol">→</a> <a id="1141" href="Free.CommutativeMonoid.Base.html#1054" class="Bound">a</a> <a id="1143" href="Data.FreshList.InductiveInductive.html#509" class="Datatype Operator">#</a> <a id="1145" class="Symbol">(</a><a id="1146" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="1152" href="Free.CommutativeMonoid.Base.html#1062" class="Bound">xs</a> <a id="1155" href="Free.CommutativeMonoid.Base.html#1065" class="Bound">ys</a> <a id="1158" href="Free.CommutativeMonoid.Base.html#1083" class="Bound">p</a><a id="1159" class="Symbol">)</a>

<a id="1162" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="1168" href="Data.FreshList.InductiveInductive.html#624" class="InductiveConstructor">[]</a> <a id="1171" href="Free.CommutativeMonoid.Base.html#1171" class="Bound">ys</a> <a id="1174" class="Symbol">(</a><a id="1175" href="Induction.WellFounded.html#1071" class="InductiveConstructor">acc</a> <a id="1179" href="Free.CommutativeMonoid.Base.html#1179" class="Bound">rs</a><a id="1181" class="Symbol">)</a> <a id="1183" class="Symbol">=</a> <a id="1185" href="Free.CommutativeMonoid.Base.html#1171" class="Bound">ys</a>
<a id="1188" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="1194" class="Symbol">(</a><a id="1195" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1200" href="Free.CommutativeMonoid.Base.html#1200" class="Bound">x</a> <a id="1202" href="Free.CommutativeMonoid.Base.html#1202" class="Bound">xs</a> <a id="1205" href="Free.CommutativeMonoid.Base.html#1205" class="Bound">x#xs</a><a id="1209" class="Symbol">)</a> <a id="1211" href="Data.FreshList.InductiveInductive.html#624" class="InductiveConstructor">[]</a> <a id="1214" class="Symbol">(</a><a id="1215" href="Induction.WellFounded.html#1071" class="InductiveConstructor">acc</a> <a id="1219" href="Free.CommutativeMonoid.Base.html#1219" class="Bound">rs</a><a id="1221" class="Symbol">)</a> <a id="1223" class="Symbol">=</a> <a id="1225" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1230" href="Free.CommutativeMonoid.Base.html#1200" class="Bound">x</a> <a id="1232" href="Free.CommutativeMonoid.Base.html#1202" class="Bound">xs</a> <a id="1235" href="Free.CommutativeMonoid.Base.html#1205" class="Bound">x#xs</a>
<a id="1240" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="1246" class="Symbol">(</a><a id="1247" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1252" href="Free.CommutativeMonoid.Base.html#1252" class="Bound">x</a> <a id="1254" href="Free.CommutativeMonoid.Base.html#1254" class="Bound">xs</a> <a id="1257" href="Free.CommutativeMonoid.Base.html#1257" class="Bound">x#xs</a><a id="1261" class="Symbol">)</a> <a id="1263" class="Symbol">(</a><a id="1264" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1269" href="Free.CommutativeMonoid.Base.html#1269" class="Bound">y</a> <a id="1271" href="Free.CommutativeMonoid.Base.html#1271" class="Bound">ys</a> <a id="1274" href="Free.CommutativeMonoid.Base.html#1274" class="Bound">y#ys</a><a id="1278" class="Symbol">)</a> <a id="1280" class="Symbol">(</a><a id="1281" href="Induction.WellFounded.html#1071" class="InductiveConstructor">acc</a> <a id="1285" href="Free.CommutativeMonoid.Base.html#1285" class="Bound">rs</a><a id="1287" class="Symbol">)</a> <a id="1289" class="Keyword">with</a> <a id="1294" href="Free.CommutativeMonoid.Base.html#736" class="Function">total</a> <a id="1300" href="Free.CommutativeMonoid.Base.html#1252" class="Bound">x</a> <a id="1302" href="Free.CommutativeMonoid.Base.html#1269" class="Bound">y</a>
<a id="1304" class="Symbol">...</a> <a id="1308" class="Symbol">|</a> <a id="1310" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="1315" href="Free.CommutativeMonoid.Base.html#1315" class="Bound">x≤y</a> <a id="1319" class="Symbol">=</a> <a id="1321" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1326" class="Bound">x</a> <a id="1328" class="Symbol">(</a><a id="1329" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="1335" class="Bound">xs</a> <a id="1338" class="Symbol">(</a><a id="1339" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1344" class="Bound">y</a> <a id="1346" class="Bound">ys</a> <a id="1349" class="Bound">y#ys</a><a id="1353" class="Symbol">)</a> <a id="1355" class="Symbol">(</a><a id="1356" class="Bound">rs</a> <a id="1359" class="Symbol">_</a> <a id="1361" href="Free.CommutativeMonoid.Base.html#500" class="Function">≤ℕ-refl</a><a id="1368" class="Symbol">))</a>
                        <a id="1395" class="Symbol">(</a><a id="1396" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1408" class="Bound">x#xs</a> <a id="1413" class="Symbol">(</a><a id="1414" href="Data.FreshList.InductiveInductive.html#4915" class="Function">#-trans</a> <a id="1422" href="Free.CommutativeMonoid.Base.html#825" class="Function">≤-trans</a> <a id="1430" class="Bound">x</a> <a id="1432" class="Bound">y</a> <a id="1434" class="Symbol">(</a><a id="1435" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1440" class="Bound">y</a> <a id="1442" class="Bound">ys</a> <a id="1445" class="Bound">y#ys</a><a id="1449" class="Symbol">)</a> <a id="1451" href="Free.CommutativeMonoid.Base.html#1315" class="Bound">x≤y</a> <a id="1455" class="Symbol">(</a><a id="1456" href="Free.CommutativeMonoid.Base.html#781" class="Function">≤-refl</a> <a id="1463" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1465" class="Bound">y#ys</a><a id="1469" class="Symbol">)))</a>
<a id="1473" class="Symbol">...</a> <a id="1477" class="Symbol">|</a> <a id="1479" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="1484" href="Free.CommutativeMonoid.Base.html#1484" class="Bound">y≤x</a> <a id="1488" class="Symbol">=</a> <a id="1490" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1495" class="Bound">y</a> <a id="1497" class="Symbol">(</a><a id="1498" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="1504" class="Symbol">(</a><a id="1505" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1510" class="Bound">x</a> <a id="1512" class="Bound">xs</a> <a id="1515" class="Bound">x#xs</a><a id="1519" class="Symbol">)</a> <a id="1521" class="Bound">ys</a> <a id="1524" class="Symbol">(</a><a id="1525" class="Bound">rs</a> <a id="1528" class="Symbol">_</a> <a id="1530" class="Symbol">(</a><a id="1531" href="Data.Nat.Base.html#1538" class="InductiveConstructor">s≤s</a> <a id="1535" class="Symbol">(</a><a id="1536" href="Free.CommutativeMonoid.Base.html#545" class="Function">≤ℕ-reflexive</a> <a id="1549" class="Symbol">(</a><a id="1550" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="1554" class="Symbol">(</a><a id="1555" href="Data.Nat.Properties.html#14215" class="Function">+-suc</a> <a id="1561" class="Symbol">_</a> <a id="1563" class="Symbol">_))))))</a>
                        <a id="1595" class="Symbol">(</a><a id="1596" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1608" class="Symbol">(</a><a id="1609" href="Data.FreshList.InductiveInductive.html#4915" class="Function">#-trans</a> <a id="1617" href="Free.CommutativeMonoid.Base.html#825" class="Function">≤-trans</a> <a id="1625" class="Bound">y</a> <a id="1627" class="Bound">x</a> <a id="1629" class="Symbol">(</a><a id="1630" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1635" class="Bound">x</a> <a id="1637" class="Bound">xs</a> <a id="1640" class="Bound">x#xs</a><a id="1644" class="Symbol">)</a> <a id="1646" href="Free.CommutativeMonoid.Base.html#1484" class="Bound">y≤x</a> <a id="1650" class="Symbol">(</a><a id="1651" href="Free.CommutativeMonoid.Base.html#781" class="Function">≤-refl</a> <a id="1658" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1660" class="Bound">x#xs</a><a id="1664" class="Symbol">))</a> <a id="1667" class="Bound">y#ys</a><a id="1671" class="Symbol">)</a>

<a id="1674" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1686" class="Symbol">{</a><a id="1687" href="Free.CommutativeMonoid.Base.html#1687" class="Bound">a</a><a id="1688" class="Symbol">}</a> <a id="1690" class="Symbol">{</a><a id="1691" href="Data.FreshList.InductiveInductive.html#624" class="InductiveConstructor">[]</a><a id="1693" class="Symbol">}</a> <a id="1695" class="Symbol">{</a><a id="1696" href="Free.CommutativeMonoid.Base.html#1696" class="Bound">ys</a><a id="1698" class="Symbol">}</a> <a id="1700" class="Symbol">{</a><a id="1701" href="Induction.WellFounded.html#1071" class="InductiveConstructor">acc</a> <a id="1705" href="Free.CommutativeMonoid.Base.html#1705" class="Bound">rs</a><a id="1707" class="Symbol">}</a> <a id="1709" href="Free.CommutativeMonoid.Base.html#1709" class="Bound">a#xs</a> <a id="1714" href="Free.CommutativeMonoid.Base.html#1714" class="Bound">a#ys</a> <a id="1719" class="Symbol">=</a> <a id="1721" href="Free.CommutativeMonoid.Base.html#1714" class="Bound">a#ys</a>
<a id="1726" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1738" class="Symbol">{</a><a id="1739" href="Free.CommutativeMonoid.Base.html#1739" class="Bound">a</a><a id="1740" class="Symbol">}</a> <a id="1742" class="Symbol">{</a><a id="1743" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1748" href="Free.CommutativeMonoid.Base.html#1748" class="Bound">x</a> <a id="1750" href="Free.CommutativeMonoid.Base.html#1750" class="Bound">xs</a> <a id="1753" href="Free.CommutativeMonoid.Base.html#1753" class="Bound">x#xs</a><a id="1757" class="Symbol">}</a> <a id="1759" class="Symbol">{</a><a id="1760" href="Data.FreshList.InductiveInductive.html#624" class="InductiveConstructor">[]</a><a id="1762" class="Symbol">}</a> <a id="1764" class="Symbol">{</a><a id="1765" href="Induction.WellFounded.html#1071" class="InductiveConstructor">acc</a> <a id="1769" href="Free.CommutativeMonoid.Base.html#1769" class="Bound">rs</a><a id="1771" class="Symbol">}</a> <a id="1773" href="Free.CommutativeMonoid.Base.html#1773" class="Bound">a#xs</a> <a id="1778" href="Free.CommutativeMonoid.Base.html#1778" class="Bound">a#ys</a> <a id="1783" class="Symbol">=</a> <a id="1785" href="Free.CommutativeMonoid.Base.html#1773" class="Bound">a#xs</a>
<a id="1790" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1802" class="Symbol">{</a><a id="1803" href="Free.CommutativeMonoid.Base.html#1803" class="Bound">a</a><a id="1804" class="Symbol">}</a> <a id="1806" class="Symbol">{</a><a id="1807" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1812" href="Free.CommutativeMonoid.Base.html#1812" class="Bound">x</a> <a id="1814" href="Free.CommutativeMonoid.Base.html#1814" class="Bound">xs</a> <a id="1817" href="Free.CommutativeMonoid.Base.html#1817" class="Bound">x#xs</a><a id="1821" class="Symbol">}</a> <a id="1823" class="Symbol">{</a><a id="1824" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="1829" href="Free.CommutativeMonoid.Base.html#1829" class="Bound">y</a> <a id="1831" href="Free.CommutativeMonoid.Base.html#1831" class="Bound">ys</a> <a id="1834" href="Free.CommutativeMonoid.Base.html#1834" class="Bound">y#ys</a><a id="1838" class="Symbol">}</a> <a id="1840" class="Symbol">{</a><a id="1841" href="Induction.WellFounded.html#1071" class="InductiveConstructor">acc</a> <a id="1845" href="Free.CommutativeMonoid.Base.html#1845" class="Bound">rs</a><a id="1847" class="Symbol">}</a> <a id="1849" class="Symbol">(</a><a id="1850" href="Free.CommutativeMonoid.Base.html#1850" class="Bound">a≤x</a> <a id="1854" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1856" href="Free.CommutativeMonoid.Base.html#1856" class="Bound">a#xs</a><a id="1860" class="Symbol">)</a> <a id="1862" class="Symbol">(</a><a id="1863" href="Free.CommutativeMonoid.Base.html#1863" class="Bound">a≤y</a> <a id="1867" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1869" href="Free.CommutativeMonoid.Base.html#1869" class="Bound">a#ys</a><a id="1873" class="Symbol">)</a> <a id="1875" class="Keyword">with</a> <a id="1880" href="Free.CommutativeMonoid.Base.html#736" class="Function">total</a> <a id="1886" href="Free.CommutativeMonoid.Base.html#1812" class="Bound">x</a> <a id="1888" href="Free.CommutativeMonoid.Base.html#1829" class="Bound">y</a>
<a id="1890" class="Symbol">...</a> <a id="1894" class="Symbol">|</a> <a id="1896" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="1901" href="Free.CommutativeMonoid.Base.html#1901" class="Bound">x≤y</a> <a id="1905" class="Symbol">=</a> <a id="1907" class="Bound">a≤x</a> <a id="1911" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1913" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1925" class="Bound">a#xs</a> <a id="1930" class="Symbol">(</a><a id="1931" class="Bound">a≤y</a> <a id="1935" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1937" class="Bound">a#ys</a><a id="1941" class="Symbol">)</a>
<a id="1943" class="Symbol">...</a> <a id="1947" class="Symbol">|</a> <a id="1949" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="1954" href="Free.CommutativeMonoid.Base.html#1954" class="Bound">y≤x</a> <a id="1958" class="Symbol">=</a> <a id="1960" class="Bound">a≤y</a> <a id="1964" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1966" href="Free.CommutativeMonoid.Base.html#1039" class="Function">union-fresh</a> <a id="1978" class="Symbol">(</a><a id="1979" class="Bound">a≤x</a> <a id="1983" href="Data.FreshList.InductiveInductive.html#766" class="InductiveConstructor Operator">∷</a> <a id="1985" class="Bound">a#xs</a><a id="1989" class="Symbol">)</a> <a id="1991" class="Bound">a#ys</a>

<a id="_∪_"></a><a id="1997" href="Free.CommutativeMonoid.Base.html#1997" class="Function Operator">_∪_</a> <a id="2001" class="Symbol">:</a> <a id="2003" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a> <a id="2027" class="Symbol">→</a> <a id="2029" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a>
<a id="2040" href="Free.CommutativeMonoid.Base.html#2040" class="Bound">xs</a> <a id="2043" href="Free.CommutativeMonoid.Base.html#1997" class="Function Operator">∪</a> <a id="2045" href="Free.CommutativeMonoid.Base.html#2045" class="Bound">ys</a> <a id="2048" class="Symbol">=</a> <a id="2050" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="2056" href="Free.CommutativeMonoid.Base.html#2040" class="Bound">xs</a> <a id="2059" href="Free.CommutativeMonoid.Base.html#2045" class="Bound">ys</a> <a id="2062" class="Symbol">(</a><a id="2063" href="Data.Nat.Induction.html#2200" class="Function">&lt;-wellFounded</a> <a id="2077" class="Symbol">(</a><a id="2078" href="Data.FreshList.InductiveInductive.html#4825" class="Function">length</a> <a id="2085" href="Free.CommutativeMonoid.Base.html#2040" class="Bound">xs</a> <a id="2088" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="2090" href="Data.FreshList.InductiveInductive.html#4825" class="Function">length</a> <a id="2097" href="Free.CommutativeMonoid.Base.html#2045" class="Bound">ys</a><a id="2099" class="Symbol">))</a>


<a id="2104" class="Comment">---------------</a>
<a id="2120" class="Comment">-- Insertion --</a>
<a id="2136" class="Comment">---------------</a>

<a id="2153" class="Comment">-- Can now define insert in terms of union</a>
<a id="insert&#39;"></a><a id="2196" href="Free.CommutativeMonoid.Base.html#2196" class="Function">insert&#39;</a> <a id="2204" class="Symbol">:</a> <a id="2206" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a> <a id="2208" class="Symbol">→</a> <a id="2210" class="Symbol">(</a><a id="2211" href="Free.CommutativeMonoid.Base.html#2211" class="Bound">xs</a> <a id="2214" class="Symbol">:</a> <a id="2216" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a><a id="2226" class="Symbol">)</a> <a id="2228" class="Symbol">→</a> <a id="2230" href="Induction.WellFounded.html#1009" class="Datatype">Acc</a> <a id="2234" href="Free.CommutativeMonoid.Base.html#339" class="Function Operator">_&lt;ℕ_</a> <a id="2239" class="Symbol">(</a><a id="2240" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2244" class="Symbol">(</a><a id="2245" href="Data.FreshList.InductiveInductive.html#4825" class="Function">length</a> <a id="2252" href="Free.CommutativeMonoid.Base.html#2211" class="Bound">xs</a><a id="2254" class="Symbol">))</a> <a id="2257" class="Symbol">→</a> <a id="2259" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a>
<a id="2270" href="Free.CommutativeMonoid.Base.html#2196" class="Function">insert&#39;</a> <a id="2278" href="Free.CommutativeMonoid.Base.html#2278" class="Bound">x</a> <a id="2280" href="Free.CommutativeMonoid.Base.html#2280" class="Bound">xs</a> <a id="2283" href="Free.CommutativeMonoid.Base.html#2283" class="Bound">p</a> <a id="2285" class="Symbol">=</a> <a id="2287" href="Free.CommutativeMonoid.Base.html#962" class="Function">union</a> <a id="2293" class="Symbol">(</a><a id="2294" href="Data.FreshList.InductiveInductive.html#641" class="InductiveConstructor">cons</a> <a id="2299" href="Free.CommutativeMonoid.Base.html#2278" class="Bound">x</a> <a id="2301" href="Data.FreshList.InductiveInductive.html#624" class="InductiveConstructor">[]</a> <a id="2304" href="Data.FreshList.InductiveInductive.html#731" class="InductiveConstructor">[]</a><a id="2306" class="Symbol">)</a> <a id="2308" href="Free.CommutativeMonoid.Base.html#2280" class="Bound">xs</a> <a id="2311" href="Free.CommutativeMonoid.Base.html#2283" class="Bound">p</a>

<a id="insert"></a><a id="2314" href="Free.CommutativeMonoid.Base.html#2314" class="Function">insert</a> <a id="2321" class="Symbol">:</a> <a id="2323" href="Free.CommutativeMonoid.Base.html#111" class="Bound">X</a> <a id="2325" class="Symbol">→</a> <a id="2327" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a> <a id="2338" class="Symbol">→</a> <a id="2340" href="Free.CommutativeMonoid.Base.html#869" class="Function">SortedList</a>
<a id="2351" href="Free.CommutativeMonoid.Base.html#2314" class="Function">insert</a> <a id="2358" href="Free.CommutativeMonoid.Base.html#2358" class="Bound">x</a> <a id="2360" href="Free.CommutativeMonoid.Base.html#2360" class="Bound">xs</a> <a id="2363" class="Symbol">=</a> <a id="2365" href="Free.CommutativeMonoid.Base.html#2196" class="Function">insert&#39;</a> <a id="2373" href="Free.CommutativeMonoid.Base.html#2358" class="Bound">x</a> <a id="2375" href="Free.CommutativeMonoid.Base.html#2360" class="Bound">xs</a> <a id="2378" class="Symbol">(</a><a id="2379" href="Data.Nat.Induction.html#2200" class="Function">&lt;-wellFounded</a> <a id="2393" class="Symbol">_)</a>
</pre></body></html>